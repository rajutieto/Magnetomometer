#include "stm32f10x.h"
#include "usart1.h" 
#include "math.h"
#include "rand.h"

/*	the header of test function  */
#include "rt_nonfinite.h"
#include "filterRollerEffect.h"
#include "filterRollerEffect_initialize.h"


/**
  * @brief  Main program.
  * @param  None
  * @retval : None
  */
u8 print_buffer[1000];

real_T resultant[238]={
534.114219994188,
534.114219994188,
536.519337955306,
536.519337955306,
536.519337955306,
542.916199795143,
542.916199795143,
542.916199795143,
549.305015451343,
549.305015451343,
549.305015451343,
557.136428534340,
557.136428534340,
557.136428534340,
563.620439657754,
563.620439657754,
563.620439657754,
569.455002612147,
569.455002612147,
569.455002612147,
573.458804100173,
573.458804100173,
573.458804100173,
579.675771444693,
579.675771444693,
579.675771444693,
583.622309374822,
583.622309374822,
583.622309374822,
591.080366786108,
591.080366786108,
591.080366786108,
600.726227161758,
600.726227161758,
600.726227161758,
610.573500898950,
610.573500898950,
610.573500898950,
620.114505555224,
620.114505555224,
620.114505555224,
629.801556047617,
629.801556047617,
636.220873596584,
638.553051828899,
638.553051828899,
645.185244716585,
646.455721608217,
646.455721608217,
646.455721608217,
647.180809357014,
647.180809357014,
647.180809357014,
647.135225435921,
647.135225435921,
655.967224790995,
657.111862623100,
657.111862623100,
665.959458225499,
667.526778489073,
667.526778489073,
676.130904485219,
677.609031817021,
677.609031817021,
685.898680564411,
687.395082903566,
687.395082903566,
695.223705004368,
696.885930407553,
696.885930407553,
704.172564077869,
704.753857740417,
704.753857740417,
710.029576848740,
709.931686854447,
709.931686854447,
709.523783956535,
708.248543944850,
708.248543944850,
706.378085730298,
703.700220264283,
703.700220264283,
696.572322160449,
694.453022169247,
694.453022169247,
694.601324502048,
693.318829976512,
693.318829976512,
693.591378262446,
693.194056523857,
693.194056523857,
699.711369065846,
700.530513254062,
700.530513254062,
712.633145454237,
712.942494174670,
712.942494174670,
728.702271164294,
728.558851432058,
728.558851432058,
739.081862854177,
738.832863373037,
738.832863373037,
739.450471634172,
738.098909361069,
738.098909361069,
736.334842310209,
734.674757971172,
734.674757971172,
729.196818424217,
727.178107481242,
727.178107481242,
722.806336441512,
721.463096769336,
721.463096769336,
720.953535257301,
720.950761148083,
720.950761148083,
731.553825770872,
731.927592047192,
731.927592047192,
744.732166620994,
745.162398407220,
745.162398407220,
752.828001604616,
753.372417865162,
753.372417865162,
758.966402418447,
759.211433001374,
759.211433001374,
755.988756530148,
755.537556975165,
755.537556975165,
749.042722413081,
748.968624175940,
748.968624175940,
739.882423091669,
740.387060935022,
740.387060935022,
740.923747763560,
741.774224410636,
741.774224410636,
746.931054381862,
748.813728506629,
748.813728506629,
755.251613702348,
756.692143477121,
756.692143477121,
764.433123301182,
765.924931047423,
765.924931047423,
773.247049784220,
774.549546510745,
774.549546510745,
777.587937149233,
777.875311344948,
772.301754497554,
772.301754497554,
772.990297481152,
768.972691322650,
768.972691322650,
770.098045705870,
763.310552789623,
763.310552789623,
763.193291375127,
759.578172408871,
759.578172408871,
760.882382500739,
760.433429038992,
760.433429038992,
761.166210495448,
768.797112377511,
768.797112377511,
769.124827319987,
774.185378317106,
774.185378317106,
775.035483058679,
776.371045312742,
776.371045312742,
776.198428238553,
772.558088430896,
772.558088430896,
772.561324426741,
766.715070935742,
766.715070935742,
766.001958222040,
751.898264394858,
751.898264394858,
751.398695766768,
743.808443081954,
743.808443081954,
743.708948446904,
740.494429418615,
740.494429418615,
741.153155562330,
747.354668146256,
747.354668146256,
748.081546357080,
752.748962138109,
752.748962138109,
753.380382011637,
761.067014132133,
761.067014132133,
761.444679540149,
757.496534645539,
757.496534645539,
757.056801039394,
743.539508028995,
743.539508028995,
742.581982006027,
727.455840584155,
727.455840584155,
725.884288299451,
712.219067422377,
712.219067422377,
711.133602074884,
707.978813242317,
707.978813242317,
707.829781797856,
714.252756382501,
714.252756382501,
713.983193079501,
724.965516421299,
724.965516421299,
725.230997682807,
736.862945194016,
736.862945194016,
737.998644985206,
744.897308358676,
744.897308358676,
745.962465543676,
746.079754449885,
746.079754449885,
746.302217603566,
741.242200633504,
741.242200633504,
741.919806987251,
730.747562431788
};

const char_T roller_type[11] = { 'c', 'o', 'n', 'd', 'i', 't', 'i', 'o', 'n','a', 'l' };
real_T  roller_removed[238] ={0.00 };
 
real_T  roller_resultantAdjust[238] = {  //define the input 
87.8179936004006,
87.6869431557515,
87.6869431557515,
88.4081444212014,
89.5712007288057,
89.5712007288057,
90.5317623820502,
90.5317623820502,
90.5317623820502,
92.2388204608017,
92.2388204608017,
92.2388204608017,
94.4563391202517,
94.4563391202517,
94.4563391202517,
94.3345111822815,
94.3345111822815,
94.3345111822815,
95.1577637400123,
95.1577637400123,
95.1577637400123,
96.4727940924280,
96.4727940924280,
96.4727940924280,
97.2882315596290,
97.2882315596290,
97.2882315596290,
98.5444062339411,
98.5444062339411,
98.5444062339411,
98.2344135219425,
98.2344135219425,
98.2344135219425,
98.6813052203912,
98.6813052203912,
98.6813052203912,
102.288806816777,
102.288806816777,
102.288806816777,
105.560409245133,
105.560409245133,
105.560409245133,
109.868102741424,
109.868102741424,
109.357212839392,
109.631199938704,
109.631199938704,
109.808924956034,
107.004672795163,
107.004672795163,
107.042047812997,
101.911726508778,
101.911726508778,
102.058806577385,
98.7572782127981,
98.7572782127981,
100.439036235918,
95.1787791474549,
95.1787791474549,
97.2728122344574,
96.7987603226405,
96.7987603226405,
99.5740930162058,
101.916632597432,
101.916632597432,
101.350875674559,
102.200782775867,
102.200782775867,
99.2370898404422,
96.3742704252541,
96.3742704252541,
95.7653381970742,
95.7653381970742,
92.8008620649615,
91.9836942071800,
91.9836942071800,
88.5268320906153,
90.8074886779719,
90.8074886779719,
92.0597631976098,
92.0597631976098,
92.0597631976098,
94.4033897696476,
94.4033897696476,
94.4033897696476,
94.2761899951414,
94.2761899951414,
94.2761899951414,
90.8515272298710,
90.8515272298710,
90.8515272298710,
89.3196506934504,
89.3196506934504,
89.3196506934504,
88.2043082847998,
88.2043082847998,
88.2043082847998,
88.7637313321156,
88.7637313321156,
88.7637313321156,
90.1110426085505,
90.1110426085505,
90.1110426085505,
88.7637313321156,
88.7637313321156,
88.7637313321156,
86.8043777697876,
86.8043777697876,
86.8043777697876,
85.1234397801217,
85.1234397801217,
85.1234397801217,
84.6049643933499,
84.6049643933499,
84.6049643933499,
88.1532756056177,
88.1532756056177,
87.6983466206747,
89.4986033410578,
89.4986033410578,
88.3459110542191,
88.1022133660670,
88.1022133660670,
87.2926113711808,
84.6167832052247,
84.6167832052247,
83.9940474081348,
79.7182538694871,
79.7182538694871,
80.9567785920364,
78.2496006379585,
78.2496006379585,
78.7654746700609,
79.2653770570733,
79.2653770570733,
79.0253124005214,
79.6931615635871,
79.6931615635871,
79.0379655608620,
78.0768851837726,
78.0768851837726,
77.6466354712167,
77.6466354712167,
76.2495901628330,
78.1280999384984,
78.1280999384984,
76.2692598626734,
79.4103267843673,
79.4103267843673,
77.4919350642375,
78.5811682275086,
78.5811682275086,
78.4028060722319,
78.4028060722319,
78.4028060722319,
74.7729897757205,
74.7729897757205,
74.7729897757205,
73.7088868454815,
73.7088868454815,
73.7088868454815,
74.2024258363566,
74.2024258363566,
74.2024258363566,
76.9740215917033,
76.9740215917033,
76.9740215917033,
80.8455317256310,
80.8455317256310,
80.8455317256310,
80.8455317256310,
80.8455317256310,
80.8455317256310,
80.8207894047070,
80.8207894047070,
80.8207894047070,
80.5853584716231,
80.5853584716231,
80.5853584716231,
80.4487414444751,
80.4487414444751,
80.4487414444751,
83.5583628370015,
83.5583628370015,
83.5583628370015,
84.2318229649578,
84.2318229649578,
81.4248119432891,
83.5942581760255,
83.5942581760255,
80.2807573457052,
82.2921624457639,
82.2921624457639,
80.6721761203948,
81.9084855189009,
81.9084855189009,
81.0678727980450,
81.6455755078008,
81.6455755078008,
78.9810103759125,
77.8203058333749,
77.8203058333749,
74.2226380560540,
71.8540186767588,
71.8540186767588,
69.7409918681545,
69.3311188291992,
68.9433867262443,
68.8007140364202,
68.7762917758248,
67.1111682683376,
65.7992775299068,
65.6297258259136,
65.0847907638891,
61.0133530028783,
58.5411709784933,
57.5033677581811,
56.9232802540374,
54.4466734947052,
53.3970542439536,
50.7322487952134,
48.7698484937232,
47.1176044443083,
47.0987205630206,
45.4375530887017,
39.2956348949291,
34.8761909285749,
30.3052430789621,
28.1830875871376,
20.0112162199170,
19.8980293334036,
12.3004514632244,
11.3251333145601,
10.1951036256969,
9.12451306965572,
7.00867008256619,
2.56602761924822,
2.28731793813758
};


int main(void)
{	 
	
	
	/* USART1 config */	
	USART1_Config();
	printf( "\r\n Test1 is Starting...... \r\n" );
	//printf( "Testing print =%f",test_obtData[1]);
	
	/*matlab function test*/
	
filterRollerEffect_initialize();
filterRollerEffect(resultant,roller_resultantAdjust,roller_type,roller_removed);
	
	printf( "\r\n Test End Successfully...... \r\n" );
	
	//checkLargeNoiseMetal_initialize();
	//largenoisemetal_stat=checkLargeNoiseMetal(cvVal,max_cv);
	
	/*findBoxspeed_initialize(); 
	box_speed = findBoxspeed(test_obtData);*/
	
	//findCV_initialize();
	//cvVal=findCV(resultant);
	
	/*print the result*/	
	sprintf((char *)print_buffer, "Test = %f",roller_removed[1]);
	printf("%s\r\n",print_buffer);
		while (1)
	{
		
	}
}
/******************* (C) COPYRIGHT 2012 WildFire Team *****END OF FILE************/
